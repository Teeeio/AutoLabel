<svg width="1200" height="1000" xmlns="http://www.w3.org/2000/svg">
  <!-- æ ·å¼å®šä¹‰ -->
  <defs>
    <style>
      .box { fill: #f0f4f8; stroke: #334155; stroke-width: 2; }
      .box-process { fill: #dbeafe; stroke: #1e40af; stroke-width: 2; }
      .box-error { fill: #fee2e2; stroke: #dc2626; stroke-width: 2; }
      .box-success { fill: #dcfce7; stroke: #16a34a; stroke-width: 2; }
      .text { font-family: monospace; font-size: 12px; fill: #1e293b; }
      .text-title { font-family: sans-serif; font-size: 16px; font-weight: bold; fill: #0f172a; }
      .text-small { font-family: monospace; font-size: 10px; fill: #64748b; }
      .arrow { stroke: #3b82f6; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-error { stroke: #ef4444; stroke-width: 2; fill: none; marker-end: url(#arrowhead-error); }
      .arrow-success { stroke: #22c55e; stroke-width: 2; fill: none; marker-end: url(#arrowhead-success); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#3b82f6" />
    </marker>
    <marker id="arrowhead-error" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ef4444" />
    </marker>
    <marker id="arrowhead-success" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#22c55e" />
    </marker>
  </defs>

  <!-- æ ‡é¢˜ -->
  <text x="600" y="30" text-anchor="middle" class="text-title">è§†é¢‘ç”Ÿæˆç®¡é“æµç¨‹å›¾</text>

  <!-- 1. è¾“å…¥é˜¶æ®µ -->
  <g transform="translate(50, 60)">
    <rect x="0" y="0" width="250" height="80" rx="5" class="box-success" />
    <text x="10" y="20" class="text-title">è¾“å…¥: å¡ç‰‡åˆ—è¡¨</text>
    <text x="10" y="40" class="text">- æœ¬åœ°è§†é¢‘è·¯å¾„</text>
    <text x="10" y="55" class="text">- æ—¶é—´èŒƒå›´ (start, end)</text>
    <text x="10" y="70" class="text">- éŸ³é¢‘æ£€æµ‹ä¿¡æ¯</text>
  </g>

  <!-- ç®­å¤´ -->
  <path d="M 300 100 L 350 100" class="arrow" />

  <!-- 2. éå†å¡ç‰‡ -->
  <g transform="translate(350, 60)">
    <rect x="0" y="0" width="250" height="80" rx="5" class="box" />
    <text x="10" y="20" class="text-title">éå†æ¯ä¸ªå¡ç‰‡</text>
    <text x="10" y="40" class="text">for (card of cards)</text>
    <text x="10" y="55" class="text">- è·å–æœ¬åœ°è·¯å¾„</text>
    <text x="10" y="70" class="text">- è®¡ç®—è£å‰ªæ—¶é•¿</text>
  </g>

  <!-- ç®­å¤´ -->
  <path d="M 600 100 L 650 100" class="arrow" />

  <!-- 3. è£å‰ªé˜¶æ®µ -->
  <g transform="translate(650, 50)">
    <rect x="0" y="0" width="300" height="150" rx="5" class="box-process" />
    <text x="10" y="20" class="text-title">æ­¥éª¤ 1: è£å‰ªè§†é¢‘ (clipVideo)</text>

    <!-- 3.1 éŸ³é¢‘æ£€æµ‹ -->
    <text x="10" y="45" class="text-title">1.1 æ£€æµ‹éŸ³é¢‘æµ</text>
    <text x="10" y="60" class="text">â†’ ffprobe æ£€æµ‹æ˜¯å¦æœ‰éŸ³é¢‘</text>
    <text x="10" y="75" class="text">â†’ sourceHasAudio = true/false</text>

    <!-- 3.2 å°è¯•æµå¤åˆ¶ -->
    <text x="10" y="95" class="text-title">1.2 å°è¯•æµå¤åˆ¶è£å‰ª</text>
    <text x="10" y="110" class="text">ffmpeg -ss X -t Y -i input -c copy output</text>

    <!-- 3.3 éªŒè¯ -->
    <text x="10" y="130" class="text-title">1.3 éªŒè¯è¾“å‡º</text>
    <text x="10" y="145" class="text">æ£€æŸ¥æ–‡ä»¶å¤§å° > 1KB && æ—¶é•¿ > 0.5s</text>
  </g>

  <!-- ç®­å¤´å‘ä¸‹ -->
  <path d="M 800 200 L 800 230" class="arrow" />

  <!-- 4. é”™è¯¯å¤„ç† -->
  <g transform="translate(650, 230)">
    <rect x="0" y="0" width="300" height="100" rx="5" class="box-error" />
    <text x="10" y="20" class="text-title">æ­¥éª¤ 2: é”™è¯¯å¤„ç†</text>
    <text x="10" y="40" class="text">if (size < 1KB || duration < 0.5s)</text>
    <text x="10" y="55" class="text">â†’ æ ‡è®° needsReencoding = true</text>
    <text x="10" y="70" class="text">â†’ åˆ é™¤å¤±è´¥çš„è¾“å‡ºæ–‡ä»¶</text>
    <text x="10" y="85" class="text">å¸¸è§åŸå› : yuvj422p æ ¼å¼ä¸å…¼å®¹</text>
  </g>

  <!-- ç®­å¤´å‘ä¸‹ -->
  <path d="M 800 330 L 800 360" class="arrow" />

  <!-- 5. é‡æ–°ç¼–ç  -->
  <g transform="translate(650, 360)">
    <rect x="0" y="0" width="300" height="120" rx="5" class="box-process" />
    <text x="10" y="20" class="text-title">æ­¥éª¤ 3: é‡æ–°ç¼–ç  (å¦‚éœ€)</text>

    <text x="10" y="45" class="text-title">3.1 æœ‰éŸ³é¢‘</text>
    <text x="10" y="60" class="text">ffmpeg -ss X -t Y -i input -c:v libx264</text>
    <text x="10" y="75" class="text">       -preset superfast -crf 23 output</text>

    <text x="10" y="95" class="text-title">3.2 æ— éŸ³é¢‘ â†’ æ·»åŠ é™éŸ³è½¨é“</text>
    <text x="10" y="110" class="text">ffmpeg -i input -f lavfi -i anullsrc</text>
  </g>

  <!-- ç®­å¤´å‘å·¦ -->
  <path d="M 650 420 L 450 420 L 450 450" class="arrow" />

  <!-- 6. æ”¶é›†ç‰‡æ®µ -->
  <g transform="translate(300, 450)">
    <rect x="0" y="0" width="300" height="80" rx="5" class="box" />
    <text x="10" y="20" class="text-title">æ­¥éª¤ 4: æ”¶é›†è£å‰ªç‰‡æ®µ</text>
    <text x="10" y="40" class="text">clips.push(outputPath)</text>
    <text x="10" y="55" class="text">æ‰€æœ‰ç‰‡æ®µè£å‰ªå®Œæˆå:</text>
    <text x="10" y="70" class="text">â†’ validPaths = [clip1, clip2, ...]</text>
  </g>

  <!-- ç®­å¤´å‘ä¸‹ -->
  <path d="M 450 530 L 450 560" class="arrow" />

  <!-- 7. æ‹¼æ¥é˜¶æ®µ -->
  <g transform="translate(200, 560)">
    <rect x="0" y="0" width="500" height="200" rx="5" class="box-process" />
    <text x="10" y="20" class="text-title">æ­¥éª¤ 5: æ‹¼æ¥è§†é¢‘ (stitchVideos)</text>

    <!-- 5.1 åˆ›å»ºåˆ—è¡¨ -->
    <text x="10" y="45" class="text-title">5.1 åˆ›å»º concat åˆ—è¡¨æ–‡ä»¶</text>
    <text x="10" y="60" class="text">concat_list.txt:</text>
    <text x="10" y="75" class="text">  file '/path/to/clip1.mp4'</text>
    <text x="10" y="90" class="text">  file '/path/to/clip2.mp4'</text>

    <!-- 5.2 æ‹¼æ¥å‘½ä»¤ -->
    <text x="10" y="115" class="text-title">5.2 æ‰§è¡Œæ‹¼æ¥å‘½ä»¤</text>
    <text x="10" y="130" class="text">ffmpeg -f concat -safe 0 -i concat_list.txt</text>
    <text x="10" y="145" class="text">       -c:v copy              â† ä¿æŒä¸åŒå¸§ç‡</text>
    <text x="10" y="160" class="text">       -c:a aac                â† éŸ³é¢‘é‡ç¼–ç </text>
    <text x="10" y="175" class="text">       -ar 48000 -ac 2         â† ç»Ÿä¸€é‡‡æ ·ç‡</text>
    <text x="10" y="190" class="text">       -fflags +genpts         â† é‡æ–°ç”ŸæˆPTS</text>
  </g>

  <!-- ç®­å¤´å‘ä¸‹ -->
  <path d="M 450 760 L 450 790" class="arrow-success" />

  <!-- 8. è¾“å‡º -->
  <g transform="translate(300, 790)">
    <rect x="0" y="0" width="300" height="100" rx="5" class="box-success" />
    <text x="10" y="20" class="text-title">âœ… è¾“å‡º: æœ€ç»ˆè§†é¢‘</text>
    <text x="10" y="40" class="text">æ–‡ä»¶: dance_timestamp.mp4</text>
    <text x="10" y="55" class="text">ç‰¹æ€§:</text>
    <text x="10" y="70" class="text">  â€¢ ä¿æŒä¸åŒå¸§ç‡ (24fps, 25fps)</text>
    <text x="10" y="85" class="text">  â€¢ éŸ³é¢‘ç»Ÿä¸€ä¸º 48000Hz AAC</text>
  </g>

  <!-- å³ä¾§è¯´æ˜æ¡† -->
  <g transform="translate(1000, 200)">
    <rect x="0" y="0" width="180" height="400" rx="5" fill="#fef3c7" stroke="#d97706" stroke-width="2" />
    <text x="10" y="20" class="text-title">å½“å‰æ–¹æ¡ˆç‰¹ç‚¹</text>

    <text x="10" y="45" class="text-title" font-size="14">âœ… ä¼˜ç‚¹</text>
    <text x="10" y="65" class="text">1. ä¿æŒä¸åŒå¸§ç‡</text>
    <text x="10" y="80" class="text">2. éŸ³é¢‘æ—¶é—´æˆ³è¿ç»­</text>
    <text x="10" y="95" class="text">3. æ— åœé¡¿å¸§</text>
    <text x="10" y="110" class="text">4. å¤„ç†é€Ÿåº¦å¿«</text>

    <text x="10" y="135" class="text-title" font-size="14">âš ï¸ å·²çŸ¥é—®é¢˜</text>
    <text x="10" y="155" class="text">- æ€»æ—¶é•¿ç•¥é•¿</text>
    <text x="10" y="170" class="text">  (52s vs 50.36s)</text>
    <text x="10" y="185" class="text">- å¯èƒ½æœ‰åœé¡¿å¸§</text>

    <text x="10" y="210" class="text-title" font-size="14">ğŸ” å¯èƒ½åŸå› </text>
    <text x="10" y="230" class="text">1. +genpts å‚æ•°</text>
    <text x="10" y="245" class="text">   å¯èƒ½å¯¼è‡´å¸§é‡å¤</text>
    <text x="10" y="260" class="text">2. éŸ³é¢‘é‡ç¼–ç </text>
    <text x="10" y="275" class="text">   æ—¶é—´æˆ³å¯¹é½é—®é¢˜</text>
    <text x="10" y="290" class="text">3. è£å‰ªç²¾åº¦</text>
    <text x="10" y="305" class="text">   å…³é”®å¸§å¯¹é½åå·®</text>

    <text x="10" y="330" class="text-title" font-size="14">ğŸ’¡ å»ºè®®</text>
    <text x="10" y="350" class="text">æ£€æŸ¥æ—¥å¿—ä¸­çš„:</text>
    <text x="10" y="365" class="text">- å®é™…è£å‰ªæ—¶é•¿</text>
    <text x="10" y="380" class="text">- æ‹¼æ¥åæ—¶é•¿</text>
    <text x="10" y="395" class="text">- æ—¶é—´æˆ³ä¿¡æ¯</text>
  </g>
</svg>